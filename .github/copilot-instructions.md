## Quick orientation for code-writing assistants

This repo is a Vite + React + TypeScript app that uses Supabase as the backend (both client SDK and Edge Functions). Keep answers focused and concrete: reference the exact files below when suggesting edits.

### Big picture (what lives where)
- UI: `src/components/ui/*` — shadcn-ui component wrappers (e.g. `button.tsx`, `input.tsx`). Small, reusable UI building blocks.
- Pages & routing: `src/pages/*` and `src/App.tsx` (routing is defined with `react-router-dom`). Example: `src/pages/Dashboard.tsx` chooses role-specific dashboards in `src/components/dashboard/*`.
- App wiring: `src/main.tsx` and `src/App.tsx` — QueryClient, Tooltip/Toaster providers, `AuthProvider` from `src/lib/auth.tsx`.
- Supabase client: `src/integrations/supabase/client.ts` — single client for browser; env vars begin with `VITE_`.
- Supabase types/schema: `src/integrations/supabase/types.ts` — autogenerated DB types, use these for typed queries.
- Server-side / Edge functions: `supabase/functions/*` (Deno-style edge functions). Shared helpers under `supabase/functions/_shared/`.
- SQL migrations: `migrations/` and `supabase/config.toml` — DB schema and migration history.

### Important commands / workflows
- Local dev: `npm i` then `npm run dev` (starts Vite). See `package.json` scripts.
- Build: `npm run build` (or `npm run build:dev` for a dev-mode build). Preview: `npm run preview`.
- Lint: `npm run lint` (ESLint is configured).
- Supabase functions/migrations: functions live in `supabase/functions` and reference `Deno.env` variables at runtime. Use the Supabase CLI to deploy functions and migrations (repo contains `supabase/config.toml`). Example (local): `supabase functions deploy bulk-signup` and `supabase db push` / `supabase db reset` as appropriate.

### Environment variables (exact names seen in repo)
- Browser client (used in `src/integrations/supabase/client.ts`):
  - `VITE_SUPABASE_URL` or `VITE_SUPABASE_PROJECT_ID` (used to construct URL)
  - `VITE_SUPABASE_ANON_KEY` or `VITE_SUPABASE_PUBLISHABLE_KEY`
- Edge functions / server (Deno env):
  - `SUPABASE_URL`
  - `SUPABASE_SERVICE_ROLE_KEY` (used by admin edge functions like `bulk-signup`)

When suggesting edits that touch envs, reference these exact names. Note: `client.ts` prints a console error if the VITE_* vars are missing — keep that behavior.

### Conventions and patterns to follow
- Path alias: `@/*` maps to `./src/*` (see `tsconfig.json`) — prefer imports like `@/components/ui/button`.
- Auth & roles: `src/lib/auth.tsx` uses `supabase.auth` listeners and queries `user_roles` table to decide which dashboard to show. If you change auth flows, update `AuthProvider` and `src/pages/Dashboard.tsx` together.
- Typed DB access: use the typed `Database` types in `src/integrations/supabase/types.ts` when calling Supabase to keep type safety.
- UI updates: prefer modifying the shadcn wrappers in `src/components/ui/*` rather than changing many pages.

### Edge functions notes (important)
- Functions are Deno-based and import `npm:@supabase/supabase-js@2` (see `supabase/functions/*`). They expect env vars via `Deno.env.get(...)`.
- Common pattern: handle CORS preflight, initialize an admin Supabase client with `SUPABASE_SERVICE_ROLE_KEY`, and return JSON with `{ success, errors, results }`. See `supabase/functions/bulk-signup/index.ts` for a complete example.

### Where to look for common tasks (examples)
- Add a new page/route: create `src/pages/MyPage.tsx`, add a `<Route path="/my" element={<MyPage/>}/>` in `src/App.tsx`.
- Add a typed DB query: import `supabase` from `src/integrations/supabase/client.ts` and use types from `src/integrations/supabase/types.ts`.
- Add a server-side endpoint: create `supabase/functions/<name>/index.ts` following `bulk-signup` pattern, reference `Deno.env` for secrets and deploy via Supabase CLI.

### Quick safety & review checks for PRs
- Do not accidentally log secret values (URLs/keys) — several functions explicitly warn about this.
- If you change DB schema, update `src/integrations/supabase/types.ts` (it appears generated) and add a migration under `migrations/`.
- Keep `VITE_` prefix for client envs — Vite only exposes envs prefixed with `VITE_` to the browser.

If anything in these notes is unclear or you want more examples (e.g., a minimal new Edge Function scaffold, or a sample `.env.local`), tell me which section to expand and I will iterate. 
